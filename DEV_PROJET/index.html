<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DB Manager - Login</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body style="align-items: center; justify-content: center;">

    <div class="card" style="width: 100%; max-width: 400px;">
        <div style="text-align: center; margin-bottom: 2rem;">
            <div
                style="width: 60px; height: 60px; background: rgba(59,130,246,0.1); border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; margin-bottom: 1rem;">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <ellipse cx="12" cy="5" rx="9" ry="3"></ellipse>
                    <path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"></path>
                    <path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"></path>
                </svg>
            </div>
            <h1 class="text-xl">Connect Database</h1>
            <p class="text-muted text-sm">Enter your MySQL credentials</p>
        </div>

        <form id="loginForm">
            <div class="input-group">
                <label class="input-label">Host</label>
                <input type="text" name="host" class="form-input" placeholder="localhost" value="localhost" required>
            </div>
            <div class="input-group">
                <label class="input-label">Username</label>
                <input type="text" name="user" class="form-input" placeholder="root" value="root" required>
            </div>
            <div class="input-group">
                <label class="input-label">Password</label>
                <input type="password" name="password" class="form-input" placeholder="••••••••">
            </div>
            <div class="input-group">
                <label class="input-label">Database Name</label>
                <input type="text" name="database" class="form-input" placeholder="my_database" required>
            </div>
            <div style="margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                <input type="checkbox" name="create" id="createDb" value="1">
                <label for="createDb" style="color: var(--text-muted); font-size: 0.875rem; cursor: pointer;">Create
                    database if not exists</label>
            </div>

            <div id="errorMsg" style="color: var(--danger); font-size: 0.875rem; margin-bottom: 1rem; display: none;">
            </div>

            <button type="submit" class="btn" style="width: 100%;">Connect to Database</button>
        </form>
    </div>

    <script src="js/app.js"></script>
    <script>
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = e.target.querySelector('button');
            const errorDiv = document.getElementById('errorMsg');

            btn.disabled = true;
            btn.textContent = 'Connecting...';
            errorDiv.style.display = 'none';

            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData.entries());

            const res = await apiCall('api/login.php', 'POST', data);

            if (res && res.ok && res.data.success) {
                window.location.href = 'dashboard.html';
            } else {
                errorDiv.textContent = res.data?.error || 'Connection failed';
                errorDiv.style.display = 'block';
                btn.disabled = false;
                btn.textContent = 'Connect to Database';
            }
        });
    </script>
</body>

</html>